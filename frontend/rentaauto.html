<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalles del Auto</title>
    <link rel="stylesheet" href="./css/rentaauto.css">
</head>
<body>
    <div class="container">
        <div id="autoDetails" class="car-details"></div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const params = new URLSearchParams(window.location.search);
            const autoId = params.get('id');
            if (autoId) {
                const response = await fetch(`../backend/index.php?accion=getAutoById&id=${autoId}`);
                const data = await response.json();
                if (data.success) {
                    const auto = data.Auto;
                    const autoDetails = document.getElementById('autoDetails');
                    autoDetails.innerHTML = `
                        <div class="car-images">
                            <img id="main-image" src="./assets/${auto.Aut_Modelo}/car-front.png" alt="${auto.Aut_Modelo}">
                            <div class="thumbnail-images">
                                <img src="./assets/${auto.Aut_Modelo}/car-front.png" alt="Front view" onclick="changeImage('./assets/${auto.Aut_Modelo}/car-front.png')">
                                <img src="./assets/${auto.Aut_Modelo}/car-car.png" alt="Side view" onclick="changeImage('./assets/${auto.Aut_Modelo}/car-car.png')">
                                <img src="./assets/${auto.Aut_Modelo}/car-back.png" alt="Back view" onclick="changeImage('./assets/${auto.Aut_Modelo}/car-back.png')">
                            </div>
                        </div>
                        <div class="car-info">
                            <h1>${auto.Aut_Marca} ${auto.Aut_Modelo}</h1>
                            <p class="price">Empieza en <strong>$${auto.Aut_Costo_Dia}/día</strong></p>
                            <p class="description">${auto.Aut_Comentario}</p>
                            <div class="specifications">
                                <h2>Especificaciones</h2>
                                <ul>
                                    <li>Motor: ${auto.Aut_Motor}</li>
                                    <li>Transmisión: ${auto.Aut_Transmision}</li>
                                    <li>Pasajeros: ${auto.Aut_Pasajeros}</li>
                                    <li>Color: ${auto.Aut_Color}</li>
                                </ul>
                            </div>
                            <div class="booking">
                                <label for="start-date">Fecha de Inicio:</label>
                                <input type="date" id="start-date" name="start-date">
                                <label for="end-date">Fecha de finalización:</label>
                                <input type="date" id="end-date" name="end-date">
                                <button onclick="bookNow()">Renta Ahora</button>
                                <p id="error-message" style="color: red; display: none;">Please select a range of at least 3 days.</p>
                            </div>
                        </div>
                    `;
                } else {
                    console.error(data.message);
                }
            } else {
                console.error('No auto ID found in URL');
            }
        });

        function changeImage(src) {
            document.getElementById('main-image').src = src;
        }

        function bookNow() {
            const startDate = document.getElementById('start-date').value;
            const endDate = document.getElementById('end-date').value;
            const errorMessage = document.getElementById('error-message');
            const start = new Date(startDate);
            const end = new Date(endDate);
            const diffTime = Math.abs(end - start);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            if (diffDays < 3) {
                errorMessage.style.display = 'block';
            } else {
                errorMessage.style.display = 'none';
                alert('Booking successful!');
            }
        }
    </script>
</body>
</html>
